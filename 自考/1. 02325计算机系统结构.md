# 计算机系统结构
## 1. 概论
### 1.1 计算机系统的层次结构

`
从使用语言的角度，一台由软、硬件组成的通用计算机系统可以被看成是按功能划分的多层机器级组成的层次结构。由高到低分别为：应用语言机器级、高级语言机器级、汇编语言机器级、操作系统机器级、传统机器语言机器级、微程序机器级。
`

* 应用语言机器（M5）：应用语言程序经应用程序包**翻译**成高级语言程序
* 高级语言机器（M4）：高级语言程序经编译程序**翻译**成汇编语言程序或是机器语言程序
* 汇编语言机器（M3）：汇编语言程序经汇编程序**翻译**成机器语言程序
* 操作系统机器（M2）: 用机器语言程序**解释**作业控制语句
* 传统机器语言机器（M1）：用微指令程序**解释**机器指令
* 微程序级机器（M0）：微指令由硬件直接执行


**固件：** 具有软件功能的硬件。如：BIOS。

**翻译：** 用转换程序将高一级机器级上的程序整个地变换成低一级机器级上等效的程序。

**解释：** 在低级机器级上用它的一串语句或指令来仿真高级机器级上的一条语句或指令的功能，是通过对高级机器级语言程序中的每条语句或指令逐条解释来实现的技术。
### 1.2 计算机系统结构、计算机组成和计算机实现
`
相同的系统结构可以有不同的组成，一种组成可以有不同的实现方法。采用不同的系统结构会使可以采用的组成技术产生差异。
`

**计算机系统结构：** 对计算机系统中各级界面的定义及其上下功能的分配，是机器语言、汇编语言程序设计者或编译程序设计者看到的看到的机器物理系统抽象。

**计算机组成：** 计算机系统结构的逻辑实现，包括机器级内部的**数据流**和**控制流**的组以及逻辑设计等。主要围绕提高速度，着重提高并行度、重叠度，以及功能的分散和设置专用功能部件来进行。

**计算机实现：** 计算机组成的物理实现，着眼于器件技术和微组装技术，其中，**器件技术**起主导作用。

### 1.3 计算机系统的软、硬件取舍及定量设计原理

**软、硬件取舍基本原则：**

* 应考虑现有硬件条件下，系统要有高的性能价格比，主要从费用、速度和其他性能要求综合考虑。
* 要考虑准备采用和可能采用的组成技术是否合理？是否可以实现？
* 不仅从硬件的角度考虑如何便于组成技术发挥器件技术的新成果、新进展，还要从软件角度考虑如何为操作系统和高级语言程序设计提供更多、更好的硬件支持。

**定量设计原理：**

* 哈夫曼压缩原理：把文件中的重复数据用更简洁的方法来表示和存储。
* Amdahl 定律：对系统中瓶颈部件采取措施提高速度后，系统性能改进的程度。
* 程序访问的局部性定律：程序执行时，90%的时间只访问整个程序的10%那一部分。

**计算机系统设计的主要任务：** 系统结构、组成和实现的设计。

**计算机系统设计的主要方法：**

* 由上而下：先考虑如何满足应用要求，定好面向应用的哪个虚拟机器级的特性和工作环境，在逐级向下设计。缺点：**不通用**。
* 由下而上：先不管应用要求，只根据目前能用器件，参照、吸收已有机器的特点，将微程序机器级和传统机器级研制出来。缺点：**性能虚高**。
* 从中间开始向两边设计：这是通用机一般采用的方法，克服由上往下和由下往上两种设计方法中，软、硬件分离和脱节的致命缺点。

### 1.4 软件、应用、器件的发展对系统结构的影响

**可移植性：** 软件不修改或只经少量修改就可以由一台机器转移到另一台机器上运行，同一软件可应用于不同的环境。

**实现软件移植的主要方法：**

* 统一高级语言：应用于系统结构相同或完全不同，受用途、看法、习惯阻挠，长期难以统一。
* 采用系列机：应用于系统结构相同或相似。
* 模拟和仿真：应用于系统结构相同或相近，一般是模拟和仿真并行。

**模拟：** 用**机器语言程序**解释虚拟机器指令。由于解释程序存储于主存中，故运行速度低，实时性差。

**仿真：** 用**微程序语言**解释虚拟机器指令。由于解释程序存储于控制器中，两种机器结构差别较大时，就很难仿真。

**器件的发展：** 计算机所用器件已从电子管、晶体管、小规模集成电路、大规模集成电路迅速发展到超大规模集成电路，并使用或开始使用砷化镓器件、高密度组装技术和光电子集成技术。

**软件的兼容：** 同一系列机软件需确保向上、向后兼容，力争向前兼容。
* 向上（下）兼容：按某档机器编制的软件，不加修改就能运行于比他高（低）档的机器上。
* 向后（前）兼容：按某个时期投入市场的该型号机器上编制的软件，不加修改就能运行于在它之后（前）投入市场的该型号机器上。

**非用户片：** 也称**通用片**，其功能是由器件厂家生产时固定的，器件的用户只能使用，不能改变器件的内部功能。

**现场片** 用户根据需要可改变器件内部功能，如可编程只读存储器PROM，使用灵活，功能强。

**用户片：** 按用户要求生产的高集成度的VLSI器件。完全按用户要求设计的用户片称为全用户片，缺点：设计周期长，费用高，销量小。

### 1.5 并行性概念与开发

**并行性含义：** 解题中具有可以同时进行运算或操作的特性，称为并行性。包括**同时性**和**并发性**。

**同时性：** 两个或多个事件在同一时刻发生。

**并发性：** 两个或多个事件在同一时间间隔内发生。

**执行程序并行性等级：** 由低到高分四级。
* 指令内部：一条指令内部各个微操作并行执行。
* 指令之间：多条指令的并行执行。
* 任务或进程之间： 多个任务或程序段的并行执行。
* 作业或程序之间： 多个作业或多道程序的并行执行。

**执行阶段并行性等级：** 
* 存储器操作并行： 在一个存储周期内访问多个字。典型：并行存储器系统。
* 处理器操作步骤并行： 执行步骤在时间上重叠流水地进行。典型：流水线处理机。
* 处理器操作并行： 在同一控制器控制下按同一指令要求对向量、数组中的各元素同时操作。典型：阵列处理机。
* 指令、任务、作业并行：多个处理机同时对多条指令和相关的多数据组进行处理。典型：多处理机。

**数据处理并行性等级：** 由低到高分四级。
* 字串位串: 同时只对一个字的一位进行处理。
* 字串位并：同时对一个字的全部位进行处理。
* 字并位串：同时对许多字的同一位进行处理。
* 字并位并：同时对许多字的全部或部分位组进行处理。

**并行性开发途径：**
* 时间重叠：引入时间概念，多个处理过程在时间上相互错开，轮流重叠地使用同一套硬件设备的各个部分。
* 资源重复：引入空间概念，重复设置硬件资源来提高可靠性或性能。
* 资源共享：软件方法，让多个用户按一定时间顺序轮流使用同一套资源来提高资源利用率，相应提高了系统性能。

**耦合度：** 多机系统中各个机器之间物理连接的紧密度和交叉作用能力的强弱。

**弗林分类法：** 按指令流和数据流的**多倍性**对计算机系统分类。
* 单指令流单数据流（SISD）
* 单指令流多数据流（SIMD）
* 多指令流单数据流（MISD）
* 多指令流多数据流（MIMD）
